#!/bin/bash

function auto-retry()
{
      let backoff=1
      false
      while [ $? -ne 0 ]; do
            echo attempting ssh
            "$@" || (sleep 1; false) 
      done
                                    
}

if ! pgrep -f "sudo /usr/local/Cellar/openvpn"> /dev/null
then
      nohup sudo /usr/local/Cellar/openvpn/2.4.7/sbin/openvpn --config /Users/taylor/secrets/client.ovpn  &>/dev/null &
      echo connecting to server
fi
auto-retry ssh -q taylor@10.0.0.10 -i /Users/taylor/secrets/manjaro
